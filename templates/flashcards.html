{% extends "layout.html" %}

{% block title %}
Flashcards - MentorMatrix
{% endblock %}

{% block other_head_stuff %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/popup.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/flashcards.css') }}">
{% endblock %}

{% block content %}
  <div class="container">
    <div class="main-content">
      <h1>Flashcards</h1>

      <!-- Deck selection -->
      <form action="{{ url_for('flashcards.flashcards') }}" method="GET" class="deck-filter">
        <label for="deck-select">Select Deck:</label>
        <select name="deck_id" id="deck-select" onchange="this.form.submit()">
          <option value="">All Decks</option>
          {% for deck in decks %}
            <option value="{{ deck.id }}" {% if deck.id == selected_deck_id %}selected{% endif %}>{{ deck.title }}</option>
          {% endfor %}
        </select>
      </form>

      <!-- Flashcard creation button -->
      <button id="openModalBtn" class="premium-button">Create New Flashcard</button>

      <!-- Search feature -->
      <form action="/search_flashcards" method="GET" class="search-bar">
        <input type="text" name="query" placeholder="Search flashcards..." value="{{ search_query or '' }}" />
        <button type="submit" class="premium-button">Search</button>
      </form>

      {% if search_query %}
        <p><strong>Search results for "{{ search_query }}":</strong></p>
      {% endif %}

      <!-- Display flashcard list -->
      <ul class="flashcard-list">
        {% for flashcard in flashcards %}
          <li class="flashcard-item">
            <div class="flashcard-content" id="flashcard-{{ loop.index }}">
              <div class="flashcard-front">
                <h2>Q: {{ flashcard.question }}</h2>
              </div>
              <div class="flashcard-back">
                <h2>A: {{ flashcard.answer }}</h2>
              </div>
            </div>
            <small>Created on: {{ flashcard.created_at }}</small>

            <!-- Edit and Delete buttons -->
            <div class="flashcard-actions">
              <form action="/edit_flashcard/{{ flashcard.id }}" method="GET" style="display: inline;">
                <button type="submit" class="edit-button">Edit</button>
              </form>
              <form action="/delete_flashcard/{{ flashcard.id }}" method="POST" style="display: inline;">
                <button type="submit" class="delete-button">Delete</button>
              </form>
            </div>
          </li>
        {% else %}
          <li>No flashcards were created. Want to make some?</li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <!-- Modal for creating a new flashcard -->
  <div id="myModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" aria-label="Close Modal">&times;</span>
      <h2>Create a New Flashcard</h2>
      <form action="/add_flashcard" method="POST">
        <label for="question">Question:</label>
        <input type="text" id="question" name="question" required>

        <label for="answer">Answer:</label>
        <textarea id="answer" name="answer" required></textarea>

        <label for="deck_id">Deck:</label>
        <select name="deck_id" id="deck-select" required>
          {% for deck in decks %}
            <option value="{{ deck.id }}">{{ deck.title }}</option>
          {% endfor %}
        </select>

        <button type="submit" class="premium-button">Save Flashcard</button>
      </form>
      <button id="closeModalBtn" class="premium-button">Cancel</button>
    </div>
  </div>

{% endblock %}
